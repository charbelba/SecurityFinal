trigger:
- main

pool:
  name: agent-pool  
  demands:
    - agent.name -equals azure-agent 


variables:
  azureWebAppName: "cloud-app" # Replace with your Azure Web App name
  azureResourceGroup: "charbel-bou-abdo" # Replace with your Azure Resource Group
  azureSubscription: "55b710a2-362e-4ac2-af29-303f85a5852c" # Replace with your Azure subscription ID or name

steps:
- task: Checkout@1
  displayName: 'Checkout Code'

  inputs:
    version: '17' # Replace with your Java version
    jdkArchitecture: 'x64'


- script: |
    ./mvnw clean package # Adjust based on your build tool
  displayName: 'Build Application'

- task: PublishPipelineArtifact@1
  displayName: 'Publish Artifact'
  inputs:
    targetPath: '$(System.DefaultWorkingDirectory)/target/*.jar' # Adjust to your artifact path
    artifact: 'drop'

- task: AzureWebApp@1
  displayName: 'Deploy to Azure Web App'
  inputs:
    azureSubscription: Azure for Students(4a0cfedc-9baf-4271-8f20-10d49fc86a68)
    appName: $(azureWebAppName)
    resourceGroupName: $(azureResourceGroup)
    package: '$(Pipeline.Workspace)/drop/*.jar' # Adjust based on your artifact location